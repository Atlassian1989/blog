httpd server
======================

Ref: http://www.inmotionhosting.com/support/website/server-usage/view-level-of-traffic-with-apache-access-log
log file:
/etc/httpd/domlogs/

access per day 
awk '{print $4}' example.com | cut -d: -f1 | uniq -c

access per hour
grep "23/Jan" example.com | cut -d[ -f2 | cut -d] -f1 | awk -F: '{print $2":00"}' | sort -n | uniq -c

access per minute
grep "23/Jan/2013:06" example.com | cut -d[ -f2 | cut -d] -f1 | awk -F: '{print $2":"$3}' | sort -nk1 -nk2 | uniq -c | awk '{ if ($1 > 10) print $0}'

Config file: /etc/httpd/conf/httpd.conf
Log file: 
Error log: /etc/httpd/logs/error_log
Access log: /etc/httpd/logs/access_log

Installation:
sudo yum update
sudo yum -y install httpd

Start/Stop
sudo /etc/init.d/httpd start/stop/status/reload

Run apache on system boot
sudo /sbin/chkconfig --levels 235 httpd on

Enable .htaccess in website folder
Allowoverride All (in httpd.con for /var/www/html)
 
Name based virtual hosts
sudo vim /etc/httpd/conf/httpd.conf
uncomment - NameVirtualHost *:80
Add:
<VirtualHost *:80>
#    ServerAdmin webmaster@dummy-host.example.com
     DocumentRoot /var/www/html
     ServerName localhost
#    ErrorLog logs/dummy-host.example.com-error_log
#    CustomLog logs/dummy-host.example.com-access_log common
</VirtualHost>

sudo vim /etc/httpd/conf.d/example.com.vhost.conf
<VirtualHost *:80>
     ServerName example.com
     ServerAlias example.com
     DocumentRoot  /var/www/example.com
</VirtualHost>
mkdir -p /var/www/example.com
sudo vim index.html
Add - hello world

sudo vim /etc/hosts
127.0.0.1 example.com


mod_wsgi installation
=====================
Install alternate python 2.7.3
https://raw.github.com/vinodpandey/blog/master/virtualenv-python2.7.3.sh
if /usr/sbin/apxs does not exists, install httpd-devel

compiling mod_wsgi
mkdir -p ~/tmp
cd ~/tmp
wget http://modwsgi.googlecode.com/files/mod_wsgi-3.4.tar.gz
tar zxvf mod_wsgi-3.4.tar.gz
cd mod_wsgi-3.4
./configure --with-python=/usr/local/bin/python2.7
make
sudo make install

module location: /usr/lib64/httpd/modules/mod_wsgi.so

sudo vim /etc/httpd/conf/httpd.conf
Add below:
LoadModule wsgi_module /usr/lib64/httpd/modules/mod_wsgi.so
AddHandler wsgi-script .wsgi

sudo /etc/init.d/httpd restart

testing mod-wsgi
----------------
sudo vim /var/www/example.com/cgi-bin/project.wsgi
def application(environ, start_response):
    status = '200 OK'
    output = 'Hello World!'
    response_headers = [('Content-type', 'text/plain'),
                        ('Content-Length', str(len(output)))]
    start_response(status, response_headers)
    return [output]

sudo chmod +x project.wsgi 

sudo vim /etc/httpd/conf.d/example.com.vhost.conf
<VirtualHost *:80>
    ServerName example.com
    ServerAlias example.com
    DocumentRoot /var/www/example.com
     <Directory /var/www/example.com>
	    Options +ExecCGI
    </Directory> 
</VirtualHost>

sudo /etc/init.d/httpd restart
Access - http://example.com/project.wsgi



Ref:
http://library.linode.com/lamp-guides/centos-6
http://articles.slicehost.com/2010/5/19/installing-apache-on-centos

